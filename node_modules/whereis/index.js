var cp = require('child_process');
var os = require ('os');

module.exports = function whereis(path, name, cb) {
  switch (os.platform()) {
	case 'darwin':
		var command = 'which ' + name;
		
		cp.exec(command, function (error, stdout, stderr) {
			if (error || stderr || stdout === '' || stdout.indexOf('\\') === -1) {
				return cb(new Error('Could not find ' + name + ' on your system'));
			} else {
				return cb(null, stdout.split('\n')[0]);
			}
		});
		break;
	case 'linux':
		var command = 'whereis ' + name;
		
		cp.exec(command, function (error, stdout, stderr) {
			if (error || stderr || stdout === '' || stdout.indexOf('\\') === -1) {
				return cb(new Error('Could not find ' + name + ' on your system'));
			} else {
				return cb(null, stdout.split(' ')[1]);
			}
		});
		break;
	case 'win32':
		var command = 'where ';
		
		if (path) {
			command += "/R \"" + path + "\" ";
		}
		command += name + ".exe";
		
		cp.exec(command, function (error, stdout, stderr) {
			if (error || stderr || stdout === '' || stdout.indexOf('\\') === -1) {
				return cb(new Error('Could not find ' + name + ' on your system'));
			} else {
				return cb(null, stdout);
			}
		});
		break;
	}
};
